#pragma once

#include "bitops/mum.h"

#include <cstdint>
/*

mum3_mixer identity:
   |   0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15
---+----------------------------------------------------------------
 0 |  16  17  17  17  17  17  17  16  17  17  17  17  17  17  17  17
16 |  17  17  17  17  16  16  16  17  17  17  16  17  16  17  17  17
32 |  17  16  17  17  16  17  17  16  17  17  16  16  16  17  17  17
48 |  16  16  16  17  17  17  17  17  17  16  17  17  16  16  16  17
min: 16, max: 17, avg: 16.7

mum3_mixer reverse:
   |   0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15
---+----------------------------------------------------------------
 0 |  17  17  16  16  17  17  17  17  16  17  16  17  16  16  17  17
16 |  17  16  17  17  17  17  16  16  16  17  17  16  16  16  16  16
32 |  16  16  17  16  17  16  17  17  17  17  17  17  17  17  16  16
48 |  16  16  17  17  17  17  17  17  17  17  16  17  17  17  17  17
min: 16, max: 17, avg: 16.6

*/

// Source: https://github.com/vnmakarov/mum-hash/blob/master/mum.h
inline uint64_t mum3_mixer(uint64_t v) noexcept {
    v = muma(v, UINT64_C(0x5341ecb41937901a)) ^ UINT64_C(0xee0e0eb5d7d35bb1);
    return muma(v ^ UINT64_C(0xee0e0eb5d7d35bb1), v);
}